<!DOCTYPE html>
<html lang="bg" data-theme="system">
<head>
  <meta charset="UTF-8" />
  <title>BGN ‚áÑ EUR –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä ‚Äì MoeToResto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Inter Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #f6f7fb;
      --bg-elevated: #ffffff;
      --fg: #111827;
      --fg-muted: #6b7280;
      --accent: #2563eb;
      --accent-soft: #dbeafe;
      --border-subtle: #e5e7eb;
      --input-bg: #f9fafb;
      --shadow-soft: 0 20px 40px rgba(15, 23, 42, 0.08);
      --error: #b91c1c;

      --font-body: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    [data-theme="dark"] {
      --bg: #020617;
      --bg-elevated: #020617;
      --fg: #e5e7eb;
      --fg-muted: #9ca3af;
      --accent: #60a5fa;
      --accent-soft: #1d4ed8;
      --border-subtle: #1f2937;
      --input-bg: #020617;
      --shadow-soft: 0 20px 40px rgba(15, 23, 42, 0.75);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: var(--font-body);
      font-size: 16px;
      background: radial-gradient(circle at top, rgba(59,130,246,0.1), transparent 55%), var(--bg);
      color: var(--fg);
      display: flex;
      justify-content: center;
      padding: 16px;
      line-height: 1.55;
    }

    @media (max-width: 480px) {
      body { font-size: 17px; }
    }

    .shell {
      max-width: 960px;
      width: 100%;
      background: radial-gradient(circle at top right, rgba(96,165,250,0.18), transparent 55%), var(--bg-elevated);
      border-radius: 24px;
      box-shadow: var(--shadow-soft);
      padding: 28px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    header {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      justify-content: space-between;
      align-items: center;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-circle {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      background: linear-gradient(135deg, #2563eb, #22c55e);
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 700;
      color: white;
      font-size: 20px;
    }

    .brand-text-title {
      font-weight: 700;
      font-size: 20px;
    }

    .brand-text-sub {
      font-size: 14px;
      color: var(--fg-muted);
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .btn {
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      padding: 8px 16px;
      background: rgba(15,23,42,0.02);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
      color: var(--fg);
    }

    .btn.active {
      border-color: var(--accent);
      background: var(--accent-soft);
      color: #0b1120;
    }

    main {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2fr);
      gap: 24px;
    }

    @media (max-width: 840px) {
      main {
        grid-template-columns: 1fr;
      }
    }

    .card {
      border-radius: 20px;
      background: rgba(15,23,42,0.02);
      border: 1px solid rgba(148,163,184,0.25);
      padding: 22px 20px 26px;
      backdrop-filter: blur(12px);
    }

    .card h2 {
      margin: 0 0 12px;
      font-size: 26px;
      font-weight: 700;
    }

    .card p {
      margin: 0 0 8px;
      font-size: 15px;
      color: var(--fg-muted);
    }

    .rate-strip {
      margin-top: 12px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(15,23,42,0.04);
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 15px;
      font-weight: 500;
    }

    .flag-pill {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.06);
    }

    .grid-head {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) repeat(2, 1fr);
      gap: 14px;
      margin-top: 18px;
      padding-bottom: 8px;
      border-bottom: 1px dashed rgba(148,163,184,0.6);
      font-size: 14px;
      color: var(--fg-muted);
      font-weight: 600;
    }

    .grid-row {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) repeat(2, 1fr);
      gap: 14px;
      align-items: center;
      margin-top: 14px;
    }

    .row-label-main {
      font-size: 16px;
      font-weight: 600;
    }

    .row-label-sub {
      font-size: 14px;
      color: var(--fg-muted);
    }

    .field {
      position: relative;
    }

    .field input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      padding: 12px 14px 12px 34px;
      font-size: 16px;
      background: var(--input-bg);
      color: var(--fg);
      outline: none;
      font-weight: 400;
    }

    .field .prefix {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 14px;
      color: var(--fg-muted);
      font-weight: 600;
    }

    .error-text {
      color: var(--error);
      font-size: 14px;
      margin-top: 6px;
      display: none;
      font-weight: 500;
    }

    .hint {
      margin-top: 14px;
      font-size: 14px;
      color: var(--fg-muted);
      line-height: 1.5;
    }

    .info-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .info-body {
      font-size: 15px;
      color: var(--fg-muted);
      line-height: 1.6;
    }

    footer {
      margin-top: 6px;
      font-size: 13px;
      color: var(--fg-muted);
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
  </style>
</head>

<body>
<div class="shell">

  <header>
    <div class="brand">
      <div class="logo-circle">‚Ç¨</div>
      <div>
        <div class="brand-text-title" data-i18n="appTitle">BGN ‚áÑ EUR –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä</div>
        <div class="brand-text-sub" data-i18n="appSubtitle">–°–º–µ—Ç–∫–∞, –ø–ª–∞—â–∞–Ω–µ –∏ –±–∞–ª–∞–Ω—Å –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–∞–Ω –∫—É—Ä—Å</div>
      </div>
    </div>

    <div class="controls">
      <button class="btn btn-lang active" data-lang="bg">üáßüá¨ BG</button>
      <button class="btn btn-lang" data-lang="en">üá™üá∫ EN</button>

      <button class="btn btn-theme" id="themeToggle">
        <span id="themeIcon">üåô</span>
        <span data-i18n="themeToggle">–¢—ä–º–µ–Ω —Ä–µ–∂–∏–º</span>
      </button>
    </div>
  </header>

  <main>

    <!-- CALCULATOR -->
    <section class="card">
      <h2 data-i18n="calcTitle">–°–º–µ—Ç–∫–∞, –ø–ª–∞—â–∞–Ω–µ –∏ –±–∞–ª–∞–Ω—Å</h2>
      <p data-i18n="calcIntro">–ü–æ–ø—ä–ª–Ω–µ—Ç–µ —Å—É–º–∞ –∑–∞ —Å–º–µ—Ç–∫–∞ –∏ –ø–ª–∞—â–∞–Ω–µ –≤ –µ–≤—Ä–æ –∏–ª–∏ –ª–µ–≤–æ–≤–µ. –ë–∞–ª–∞–Ω—Å—ä—Ç —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>

      <div class="rate-strip">
        <span class="flag-pill">üáßüá¨ + üá™üá∫</span>
        <span data-i18n="rateLabel">–û—Ñ–∏—Ü–∏–∞–ª–µ–Ω –∫—É—Ä—Å:</span>
        <strong>1 EUR = 1.95583 BGN</strong>
      </div>

      <div class="grid-head">
        <div data-i18n="colOperation">–û–ø–µ—Ä–∞—Ü–∏—è</div>
        <div>EUR</div>
        <div>BGN</div>
      </div>

      <!-- BILL -->
      <div class="grid-row">
        <div>
          <div class="row-label-main" data-i18n="rowBill">–°–º–µ—Ç–∫–∞</div>
          <div class="row-label-sub" data-i18n="rowBillSub">–°—É–º–∞ –ø–æ —Ñ–∞–∫—Ç—É—Ä–∞ / –¥—ä–ª–∂–∏–º–∞ —Å—É–º–∞</div>
        </div>
        <div class="field">
          <span class="prefix">‚Ç¨</span>
          <input type="number" id="billEur" data-row="bill" data-currency="eur" step="0.01" min="0" />
        </div>
        <div class="field">
          <span class="prefix">–ª–≤.</span>
          <input type="number" id="billBgn" data-row="bill" data-currency="bgn" step="0.01" min="0" />
        </div>
      </div>

      <!-- PAYMENT -->
      <div class="grid-row">
        <div>
          <div class="row-label-main" data-i18n="rowPayment">–ü–ª–∞—â–∞–Ω–µ</div>
          <div class="row-label-sub" data-i18n="rowPaymentSub">–†–µ–∞–ª–Ω–æ –ø–ª–∞—Ç–µ–Ω–∞ —Å—É–º–∞</div>
        </div>
        <div class="field">
          <span class="prefix">‚Ç¨</span>
          <input type="number" id="payEur" data-row="payment" data-currency="eur" step="0.01" min="0" />
        </div>
        <div class="field">
          <span class="prefix">–ª–≤.</span>
          <input type="number" id="payBgn" data-row="payment" data-currency="bgn" step="0.01" min="0" />
        </div>
      </div>

      <!-- BALANCE -->
      <div class="grid-row">
        <div>
          <div class="row-label-main" data-i18n="rowBalance">–ë–∞–ª–∞–Ω—Å</div>
          <div class="row-label-sub" data-i18n="rowBalanceSub">–ü–ª–∞—â–∞–Ω–µ ‚àí –°–º–µ—Ç–∫–∞ (—Ä–µ—Å—Ç–æ—Ç–æ / –æ—Å—Ç–∞–≤–∞—â–æ –∑–∞ –ø–ª–∞—â–∞–Ω–µ)</div>
        </div>
        <div class="field">
          <span class="prefix">‚Ç¨</span>
          <input type="text" id="balEur" readonly />
        </div>
        <div class="field">
          <span class="prefix">–ª–≤.</span>
          <input type="text" id="balBgn" readonly />
        </div>
      </div>

      <div class="error-text" id="errorText" data-i18n="errorText">–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–Ω–∏ —á–∏—Å–ª–∞.</div>
    </section>

    <!-- RULES CARD -->
    <section class="card">
      <div class="info-title" data-i18n="infoTitle">–ü—Ä–∞–≤–∏–ª–∞ –∑–∞ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞–Ω–µ –∏ —Ñ–∏–∫—Å–∏—Ä–∞–Ω –∫—É—Ä—Å</div>

      <div class="info-body" data-i18n="infoBody">
        –û—Ñ–∏—Ü–∏–∞–ª–Ω–∏—è—Ç –≤–∞–ª—É—Ç–µ–Ω –∫—É—Ä—Å <strong>–Ω–µ —Å–µ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞ –∏–ª–∏ —Å—ä–∫—Ä–∞—â–∞–≤–∞</strong> –ø—Ä–∏ –ø—Ä–µ–≤–∞–ª—É—Ç–∏—Ä–∞–Ω–µ.
        –í—Å–∏—á–∫–∏ —Å—É–º–∏ —Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞—Ç —Å –ø—ä–ª–Ω–∏—è –∫—É—Ä—Å <strong>1 EUR = 1.95583 BGN</strong>, –∏–∑–ø–∏—Å–∞–Ω —Å –ø–µ—Ç –∑–Ω–∞–∫–∞ —Å–ª–µ–¥
        –¥–µ—Å–µ—Ç–∏—á–Ω–∞—Ç–∞ –∑–∞–ø–µ—Ç–∞—è. –ü–æ–ª—É—á–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ —Å–µ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞—Ç –¥–æ –¥–≤–∞ –∑–Ω–∞–∫–∞ —Å–ª–µ–¥ –∑–∞–ø–µ—Ç–∞—è—Ç–∞ –ø–æ —Å–ª–µ–¥–Ω–æ—Ç–æ –ø—Ä–∞–≤–∏–ª–æ:
        —Ç—Ä–µ—Ç–∏—è—Ç –∑–Ω–∞–∫ —Å–ª–µ–¥ –¥–µ—Å–µ—Ç–∏—á–Ω–∞—Ç–∞ –∑–∞–ø–µ—Ç–∞—è, –∞–∫–æ –µ –ø–æ-–º–∞–ª—ä–∫ –æ—Ç 5, –≤—Ç–æ—Ä–∏—è—Ç –æ—Å—Ç–∞–≤–∞ –Ω–µ–ø—Ä–æ–º–µ–Ω–µ–Ω; –∞–∫–æ –µ —Ä–∞–≤–µ–Ω –∏–ª–∏
        –ø–æ-–≥–æ–ª—è–º –æ—Ç 5, –≤—Ç–æ—Ä–∏—è—Ç —Å–µ —É–≤–µ–ª–∏—á–∞–≤–∞ —Å –µ–¥–Ω–æ. –¢–æ–∑–∏ –∫–∞–ª–∫—É–ª–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏–ª–∞–≥–∞ —Ç–µ–∑–∏ –ø—Ä–∞–≤–∏–ª–∞.
      </div>

      <!-- MOVED HINT -->
      <div class="hint" style="margin-top:18px;">
        <span data-i18n="hintTitle"><strong>–ó–∞–±–µ–ª–µ–∂–∫–∞:</strong> –ø—Ä–µ–≤–∞–ª—É—Ç–∏—Ä–∞–Ω–µ—Ç–æ –∏–∑–ø–æ–ª–∑–≤–∞ –ø—ä–ª–Ω–∏—è –∫—É—Ä—Å 1.95583.</span>
        <ul>
          <li data-i18n="hint1">–°—É–º–∏—Ç–µ —Å–µ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞—Ç –¥–æ 2 –∑–Ω–∞–∫–∞ —Å–ª–µ–¥ –∑–∞–ø–µ—Ç–∞—è—Ç–∞.</li>
          <li data-i18n="hint2">–¢—Ä–µ—Ç–∏—è—Ç –∑–Ω–∞–∫ < 5 ‚Üí –≤—Ç–æ—Ä–∏—è—Ç –æ—Å—Ç–∞–≤–∞ —Å—ä—â–∏—è—Ç.</li>
          <li data-i18n="hint3">–¢—Ä–µ—Ç–∏—è—Ç –∑–Ω–∞–∫ ‚â• 5 ‚Üí –≤—Ç–æ—Ä–∏—è—Ç —Å–µ —É–≤–µ–ª–∏—á–∞–≤–∞ —Å 1.</li>
        </ul>
      </div>
    </section>

  </main>

  <footer>
    <div data-i18n="footerLeft">MoeToResto ¬∑ BGN ‚áÑ EUR –ø–æ–º–æ—â –∑–∞ –ø—Ä–µ—Ö–æ–¥–Ω–∏—è –ø–µ—Ä–∏–æ–¥</div>
    <div data-i18n="footerRight">–°–∞–π—Ç –∑–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è ‚Äì –Ω–µ –∑–∞–º–µ–Ω—è –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏ —Ä–∞–∑—è—Å–Ω–µ–Ω–∏—è.</div>
  </footer>

</div>

<script>
const RATE = 1.95583;

const translations = {
  bg: {
    appTitle: "BGN ‚áÑ EUR –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä",
    appSubtitle: "–°–º–µ—Ç–∫–∞, –ø–ª–∞—â–∞–Ω–µ –∏ –±–∞–ª–∞–Ω—Å –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–∞–Ω –∫—É—Ä—Å",
    themeToggle: "–¢—ä–º–µ–Ω —Ä–µ–∂–∏–º",
    calcTitle: "–°–º–µ—Ç–∫–∞, –ø–ª–∞—â–∞–Ω–µ –∏ –±–∞–ª–∞–Ω—Å",
    calcIntro: "–ü–æ–ø—ä–ª–Ω–µ—Ç–µ —Å—É–º–∞ –∑–∞ —Å–º–µ—Ç–∫–∞ –∏ –ø–ª–∞—â–∞–Ω–µ –≤ –µ–≤—Ä–æ –∏–ª–∏ –ª–µ–≤–æ–≤–µ. –ë–∞–ª–∞–Ω—Å—ä—Ç —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.",
    rateLabel: "–û—Ñ–∏—Ü–∏–∞–ª–µ–Ω –∫—É—Ä—Å:",
    colOperation: "–û–ø–µ—Ä–∞—Ü–∏—è",
    rowBill: "–°–º–µ—Ç–∫–∞",
    rowBillSub: "–°—É–º–∞ –ø–æ —Ñ–∞–∫—Ç—É—Ä–∞ / –¥—ä–ª–∂–∏–º–∞ —Å—É–º–∞",
    rowPayment: "–ü–ª–∞—â–∞–Ω–µ",
    rowPaymentSub: "–†–µ–∞–ª–Ω–æ –ø–ª–∞—Ç–µ–Ω–∞ —Å—É–º–∞",
    rowBalance: "–ë–∞–ª–∞–Ω—Å",
    rowBalanceSub: "–ü–ª–∞—â–∞–Ω–µ ‚àí –°–º–µ—Ç–∫–∞ (—Ä–µ—Å—Ç–æ—Ç–æ / –æ—Å—Ç–∞–≤–∞—â–æ –∑–∞ –ø–ª–∞—â–∞–Ω–µ)",
    errorText: "–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–Ω–∏ —á–∏—Å–ª–∞.",
    hintTitle: "<strong>–ó–∞–±–µ–ª–µ–∂–∫–∞:</strong> –ø—Ä–µ–≤–∞–ª—É—Ç–∏—Ä–∞–Ω–µ—Ç–æ –∏–∑–ø–æ–ª–∑–≤–∞ –ø—ä–ª–Ω–∏—è –∫—É—Ä—Å 1.95583.",
    hint1: "–°—É–º–∏—Ç–µ —Å–µ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞—Ç –¥–æ 2 –∑–Ω–∞–∫–∞ —Å–ª–µ–¥ –∑–∞–ø–µ—Ç–∞—è—Ç–∞.",
    hint2: "–¢—Ä–µ—Ç–∏—è—Ç –∑–Ω–∞–∫ < 5 ‚Üí –≤—Ç–æ—Ä–∏—è—Ç –æ—Å—Ç–∞–≤–∞ —Å—ä—â–∏—è—Ç.",
    hint3: "–¢—Ä–µ—Ç–∏—è—Ç –∑–Ω–∞–∫ ‚â• 5 ‚Üí –≤—Ç–æ—Ä–∏—è—Ç —Å–µ —É–≤–µ–ª–∏—á–∞–≤–∞ —Å 1.",
    infoTitle: "–ü—Ä–∞–≤–∏–ª–∞ –∑–∞ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞–Ω–µ –∏ —Ñ–∏–∫—Å–∏—Ä–∞–Ω –∫—É—Ä—Å",
    infoBody:
      "–û—Ñ–∏—Ü–∏–∞–ª–Ω–∏—è—Ç –≤–∞–ª—É—Ç–µ–Ω –∫—É—Ä—Å <strong>–Ω–µ —Å–µ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞ –∏–ª–∏ —Å—ä–∫—Ä–∞—â–∞–≤–∞</strong> –ø—Ä–∏ –ø—Ä–µ–≤–∞–ª—É—Ç–∏—Ä–∞–Ω–µ. " +
      "–í—Å–∏—á–∫–∏ —Å—É–º–∏ —Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞—Ç —Å –ø—ä–ª–Ω–∏—è –∫—É—Ä—Å <strong>1 EUR = 1.95583 BGN</strong>, –∏–∑–ø–∏—Å–∞–Ω —Å –ø–µ—Ç –∑–Ω–∞–∫–∞ —Å–ª–µ–¥ " +
      "–¥–µ—Å–µ—Ç–∏—á–Ω–∞—Ç–∞ –∑–∞–ø–µ—Ç–∞—è. –ü–æ–ª—É—á–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ —Å–µ –∑–∞–∫—Ä—ä–≥–ª—è–≤–∞—Ç –¥–æ –¥–≤–∞ –∑–Ω–∞–∫–∞ —Å–ª–µ–¥ –∑–∞–ø–µ—Ç–∞—è—Ç–∞ –ø–æ —Å–ª–µ–¥–Ω–æ—Ç–æ –ø—Ä–∞–≤–∏–ª–æ: " +
      "—Ç—Ä–µ—Ç–∏—è—Ç –∑–Ω–∞–∫ –∞–∫–æ –µ <5 ‚Üí –≤—Ç–æ—Ä–∏—è—Ç –æ—Å—Ç–∞–≤–∞ –Ω–µ–ø—Ä–æ–º–µ–Ω–µ–Ω; –∞–∫–æ –µ ‚â•5 ‚Üí –≤—Ç–æ—Ä–∏—è—Ç —Å–µ —É–≤–µ–ª–∏—á–∞–≤–∞ —Å 1.",
    footerLeft: "MoeToResto ¬∑ BGN ‚áÑ EUR –ø–æ–º–æ—â –∑–∞ –ø—Ä–µ—Ö–æ–¥–Ω–∏—è –ø–µ—Ä–∏–æ–¥",
    footerRight: "–°–∞–π—Ç –∑–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è ‚Äì –Ω–µ –∑–∞–º–µ–Ω—è –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏ —Ä–∞–∑—è—Å–Ω–µ–Ω–∏—è."
  },

  en: {
    appTitle: "BGN ‚áÑ EUR Calculator",
    appSubtitle: "Bill, payment and balance at the fixed rate",
    themeToggle: "Dark mode",
    calcTitle: "Bill, Payment and Balance",
    calcIntro: "Enter bill and payment amounts in EUR or BGN. The balance is calculated automatically.",
    rateLabel: "Official rate:",
    colOperation: "Operation",
    rowBill: "Bill",
    rowBillSub: "Invoice amount / amount due",
    rowPayment: "Payment",
    rowPaymentSub: "Amount effectively paid",
    rowBalance: "Balance",
    rowBalanceSub: "Payment ‚àí Bill (change / remaining to pay)",
    errorText: "Please enter valid numbers.",
    hintTitle: "<strong>Note:</strong> conversion uses the full rate 1.95583.",
    hint1: "Amounts are rounded to 2 decimal places.",
    hint2: "Third decimal < 5 ‚Üí second stays the same.",
    hint3: "Third decimal ‚â• 5 ‚Üí second increases by one.",
    infoTitle: "Rounding rules and fixed rate",
    infoBody:
      "The official exchange rate <strong>is not rounded or shortened</strong> during conversion. " +
      "All amounts are converted using the full rate <strong>1 EUR = 1.95583 BGN</strong>. " +
      "Results are rounded to two decimals using the third decimal digit.",
    footerLeft: "MoeToResto ¬∑ BGN ‚áÑ EUR helper for the transition period",
    footerRight: "Demonstration site ‚Äì does not replace official guidance."
  }
};

let currentLang = "bg";
let lastEdited = { bill: null, payment: null };

function roundHalfUp(v, d = 2) {
  const f = Math.pow(10, d);
  return Math.round((v + Number.EPSILON) * f) / f;
}

function updateLanguage(lang) {
  currentLang = lang;
  const dict = translations[lang];

  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.dataset.i18n;
    const text = dict[key];
    if (!text) return;
    if (text.includes("<")) el.innerHTML = text;
    else el.textContent = text;
  });

  document.querySelectorAll(".btn-lang").forEach(btn =>
    btn.classList.toggle("active", btn.dataset.lang === lang)
  );
}

function getNumber(v) {
  if (v === "" || v === null) return null;
  const n = Number(v);
  return Number.isFinite(n) ? n : null;
}

function recalc() {
  const billEurEl = billEur, billBgnEl = billBgn;
  const payEurEl = payEur, payBgnEl = payBgn;
  const balEurEl = balEur, balBgnEl = balBgn;
  const errorEl = errorText;

  errorEl.style.display = "none";

  let billEur = getNumber(billEurEl.value);
  let billBgn = getNumber(billBgnEl.value);
  let payEur = getNumber(payEurEl.value);
  let payBgn = getNumber(payBgnEl.value);

  if (lastEdited.bill === "eur" && billEur !== null) {
    billBgn = roundHalfUp(billEur * RATE);
    billBgnEl.value = billBgn.toFixed(2);
  }
  if (lastEdited.bill === "bgn" && billBgn !== null) {
    billEur = roundHalfUp(billBgn / RATE);
    billEurEl.value = billEur.toFixed(2);
  }

  if (lastEdited.payment === "eur" && payEur !== null) {
    payBgn = roundHalfUp(payEur * RATE);
    payBgnEl.value = payBgn.toFixed(2);
  }
  if (lastEdited.payment === "bgn" && payBgn !== null) {
    payEur = roundHalfUp(payBgn / RATE);
    payEurEl.value = payEur.toFixed(2);
  }

  billEur = getNumber(billEurEl.value);
  payEur = getNumber(payEurEl.value);

  if (billEur === null || payEur === null) {
    balEurEl.value = "";
    balBgnEl.value = "";
    return;
  }

  const balEur = roundHalfUp(payEur - billEur);
  const balBgn = roundHalfUp(balEur * RATE);

  balEurEl.value = balEur.toFixed(2);
  balBgnEl.value = balBgn.toFixed(2);
}

document.querySelectorAll("input[data-row]").forEach(input =>
  input.addEventListener("input", e => {
    lastEdited[e.target.dataset.row] = e.target.dataset.currency;
    recalc();
  })
);

document.querySelectorAll(".btn-lang").forEach(btn =>
  btn.addEventListener("click", () => updateLanguage(btn.dataset.lang))
);

function applyTheme(theme) {
  document.documentElement.setAttribute("data-theme", theme);

  const icon = themeIcon;
  const label = document.querySelector('[data-i18n="themeToggle"]');

  if (theme === "dark") {
    icon.textContent = "‚òÄÔ∏è";
    label.textContent = currentLang === "bg" ? "–°–≤–µ—Ç—ä–ª —Ä–µ–∂–∏–º" : "Light mode";
  } else {
    icon.textContent = "üåô";
    label.textContent = currentLang === "bg" ? "–¢—ä–º–µ–Ω —Ä–µ–∂–∏–º" : "Dark mode";
  }
}

const savedTheme = localStorage.getItem("theme") || "light";
applyTheme(savedTheme);

themeToggle.addEventListener("click", () => {
  const next = document.documentElement.getAttribute("data-theme") === "dark" ? "light" : "dark";
  localStorage.setItem("theme", next);
  applyTheme(next);
});

updateLanguage("bg");
</script>
</body>
</html>
